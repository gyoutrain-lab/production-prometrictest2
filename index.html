<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Prometric Test Dashboard</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #eef2f7;
  margin: 0;
  padding: 0;
  text-align: center;
}
.container {
  width: 90%;
  max-width: 420px;
  margin: auto;
  margin-top: 40px;
  background: white;
  padding: 25px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
input {
  width: 100%;
  padding: 12px;
  margin-top: 8px;
  border-radius: 8px;
  border: 1px solid #bbb;
  font-size: 16px;
}
button {
  width: 100%;
  background: #0066ff;
  color: white;
  border: none;
  padding: 14px;
  margin-top: 12px;
  border-radius: 8px;
  font-size: 18px;
}
button:disabled {
  background: #cccccc;
}
</style>

<script>
let unlockValid = false;

// Save candidate: Name + WA
function registerCandidate() {
  const name = document.getElementById("name").value.trim();
  const wa = document.getElementById("wa").value.trim();

  if (!name || !wa) {
    alert("Please fill Name and WhatsApp Number");
    return;
  }

  google.script.run
    .withSuccessHandler(function(res){
      alert("Registration saved.\nAdmin will send Unlock Code.");
      document.getElementById("unlock").disabled = false;
    })
    .saveCandidate(name, wa);
}

// Validate Unlock Code
function verifyCode() {
  const code = document.getElementById("unlock").value.trim();

  google.script.run
    .withSuccessHandler(function(res){
      if (res.valid) {
        unlockValid = true;
        alert("Unlock Code Verified!");
        document.getElementById("previewBtn").disabled = false;
      } else {
        alert("Invalid Unlock Code");
        unlockValid = false;
      }
    })
    .validateUnlock(code);
}

// Open Test Preview â†’ real quiz selection page
function openPreview() {
  if (!unlockValid) {
    alert("Enter valid unlock code first");
    return;
  }

  window.location.href =
    "https://script.google.com/macros/s/AKfycby8o5Ei4aZog1y301nuD73V2XRjwLovY5GpkOjDsYKDrKsQOZLRY9qpU5w3MEcMPcEv/exec";
}
</script>

</head>

<body>
<div class="container">
<h2>Prometric Test Dashboard</h2>

<input id="name" placeholder="Full Name">
<input id="wa" placeholder="WhatsApp Number">

<button onclick="registerCandidate()">Save Registration</button>

<input id="unlock" placeholder="Enter Unlock Code" disabled>
<button onclick="verifyCode()">Verify Unlock</button>

<button id="previewBtn" onclick="openPreview()" disabled>
  Test Preview / Start Test
</button>

</div>
</body>
</html>
