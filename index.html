<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nursing Prometric Actual Simulation Test</title>

<meta property="og:title" content="Nursing Prometric Actual Simulation Test">
<meta property="og:description" content="Prepared based on the Prometric/SMLE and ENCLEX prometric test materials. Increase your knowledge for your smart career tracking.">
<meta property="og:image" content="https://raw.githubusercontent.com/gyoutrain-lab/production-prometrictest2/main/assets/icon17%20(7).jpg">

<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#eef5f5; color:#222; text-align:center; overflow-x: hidden; }
header { position: relative; width: 100%; height: 50vh; overflow: hidden; }
header::before, header::after { content:""; position:absolute; top:0; left:0; width:100%; height:100%; background: url('https://raw.githubusercontent.com/gyoutrain-lab/production-prometrictest2/main/assets/icon17%20(7).jpg') center/cover no-repeat; opacity:0.08; z-index:1; }
header::before { animation: wave1 8s ease-in-out infinite; }
header::after  { animation: wave2 10s ease-in-out infinite; }
header img { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); max-height:250px; z-index:2; }

h1 { margin-top:20px; font-size:2em; color:#007b83; }
h2 { margin:5px 0; font-size:1.1em; color:#333; }

form { position:fixed; bottom:20px; left:20px; width:280px; background:#fff; border-radius:10px; padding:15px; box-shadow:0 2px 10px rgba(0,0,0,0.2); text-align:left; }
form label { display:block; margin-top:10px; font-weight:bold; }
form input { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }

.qr-container { position:fixed; bottom:20px; right:20px; width:150px; background:#fff; padding:10px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.2); text-align:center; }

.buttons-center { margin:20px auto; display:flex; justify-content:center; gap:15px; }
.buttons-center button { padding:10px 20px; border:none; border-radius:5px; font-size:1em; color:#fff; cursor:pointer; }
.buttons-center button.confirm { background:#007b83; }
.buttons-center button.continue { background:#28a745; }

.notification { position:fixed; top:10px; right:10px; background:#28a745; color:#fff; padding:10px; border-radius:5px; display:none; z-index:999; }

@media screen and (max-width:480px){
  form, .qr-container { position:static; width:90%; margin:10px auto; }
  .buttons-center { flex-direction:column; }
}
</style>
</head>

<body>

<header>
  <img src="https://raw.githubusercontent.com/gyoutrain-lab/production-prometrictest2/main/assets/icon17%20(7).jpg">
</header>

<h1>Nursing Prometric Actual Simulation Test</h1>
<h2>Prepared based on the Prometric/SMLE and ENCLEX prometric test materials</h2>
<h2>Increase your knowledge for your smart career tracking</h2>

<div class="buttons-center">
  <button class="confirm" id="btnConfirm">Confirmation</button>
  <button class="continue" id="btnContinue">Continue Test</button>
</div>

<form id="unlockForm">
  <label>Name</label>
  <input type="text" id="name">

  <label>WhatsApp Number</label>
  <input type="text" id="whatsapp">

  <label>Unlock Code</label>
  <input type="text" id="code" readonly>
</form>

<div class="qr-container">
  <img src="https://raw.githubusercontent.com/gyoutrain-lab/production-prometrictest2/main/assets/dana_qr.png">
</div>

<div class="notification" id="notification"></div>

<script>
const DEPLOY_URL = "https://script.google.com/macros/s/AKfycbyOgx6n0ePWlLSW4FGZuVWusStOh4D3SHP90nr6essMUrsPTZPYIpFwn6dw5lBYGgpp/exec"; // <-- replace after I give you backend

const btnConfirm = document.getElementById('btnConfirm');
const btnContinue = document.getElementById('btnContinue');
const codeInput = document.getElementById('code');
const notif = document.getElementById('notification');

let polling = null;

function notify(msg){
  notif.innerText = msg;
  notif.style.display = "block";
  setTimeout(()=> notif.style.display="none", 3500);
}

async function sendConfirmation(){
  const name = document.getElementById("name").value.trim();
  const whatsapp = document.getElementById("whatsapp").value.trim();

  if(!name || !whatsapp){ return notify("Please fill Name and WhatsApp."); }

  btnConfirm.disabled = true;
  btnConfirm.innerText = "Submitting...";

  try{
    const res = await fetch(DEPLOY_URL, {
      method:"POST",
      body: JSON.stringify({ action:"confirm", name, whatsapp, deviceId:navigator.userAgent })
    });

    const data = await res.json();

    if(data.ok){
      notify("Confirmation submitted!");
      if(!polling){
        polling = setInterval(()=> checkStatus(name, whatsapp), 5000);
      }
    } else {
      notify(data.message || "Error.");
    }

  } catch(e){
    notify("Network error.");
  }

  btnConfirm.disabled = false;
  btnConfirm.innerText = "Confirmation";
}

async function checkStatus(name, whatsapp){
  try{
    const res = await fetch(DEPLOY_URL, {
      method:"POST",
      body: JSON.stringify({ action:"checkStatus", name, whatsapp })
    });

    const data = await res.json();

    if(data.ok && data.status === "Verified"){
      codeInput.value = data.unlockCode;
      notify("Payment verified!");
      clearInterval(polling);
      polling = null;
    }
  } catch(e){
    console.log("Polling error:", e);
  }
}

btnConfirm.onclick = sendConfirmation;

btnContinue.onclick = () => {
  if(codeInput.value.trim() !== ""){
    window.location.href = "quiz.html";
  } else {
    notify("Unlock Code not available yet.");
  }
};
</script>

</body>
</html>
