<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SMLE ‚Äî Candidate Dashboard (Mock)</title>
  <meta name="description" content="SCFHS / SMLE style CBT landing page (C2 modern green-white). Embed your external test script here." />
  <style>
    /* SMLE C2-inspired styling (green + white, rounded cards) */
    :root{
      --green-900:#053017; --green-700:#0b6b3a; --green-500:#197a3f; --muted:#6b7280; --panel:#ffffff; --bg:#f6f8f9;
      --shadow: 0 8px 24px rgba(2,6,23,0.06);
      font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:#0b1220}
    .site{max-width:1100px;margin:28px auto;padding:18px}

    /* Header */
    .topbar{background:linear-gradient(90deg,var(--green-700),var(--green-500));padding:18px;border-radius:10px;color:#fff;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:56px;height:56px;border-radius:8px;background:rgba(255,255,255,0.06);display:flex;align-items:center;justify-content:center;font-weight:700}
    .brand h1{margin:0;font-size:20px;letter-spacing:0.2px}
    .timer{font-weight:700;font-size:20px;opacity:0.95}

    /* Main layout */
    .layout{display:grid;grid-template-columns:1fr 340px;gap:18px;margin-top:18px}
    @media(max-width:920px){.layout{grid-template-columns:1fr}}

    /* Cards */
    .card{background:var(--panel);border-radius:12px;box-shadow:var(--shadow);padding:18px}
    .muted{color:var(--muted);font-size:13px}
    h2{margin:0 0 8px;font-size:16px}

    /* Preview frame area */
    .preview-wrap{border-radius:10px;border:1px solid rgba(11,17,32,0.06);overflow:hidden;height:560px;background:#fafafa}
    .preview-empty{height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;color:var(--muted)}
    .preview-empty .ico{font-size:48px;opacity:0.08;margin-bottom:6px}

    /* Controls */
    .controls{display:flex;gap:10px;margin-top:12px}
    .btn{padding:10px 14px;border-radius:8px;border:0;cursor:pointer;font-weight:700}
    .btn.primary{background:linear-gradient(180deg,var(--green-700),var(--green-500));color:#fff}
    .btn.ghost{background:transparent;border:1px solid rgba(11,17,32,0.06);color:var(--green-900)}

    /* Sidebar meta */
    .meta{display:flex;flex-direction:column;gap:12px}
    .meta-row{display:flex;justify-content:space-between;align-items:center}
    .meta .title{font-size:13px;color:var(--muted)}
    .status-bubble{padding:6px 10px;border-radius:999px;font-weight:700;background:rgba(15,46,24,0.07);color:var(--green-900)}

    /* Footer note */
    .note{margin-top:12px;font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="site">
    <div class="topbar" role="banner">
      <div class="brand">
        <div class="logo">SCF</div>
        <div>
          <h1>Computer-Based Test ‚Äî SMLE (Mock)</h1>
          <div class="muted">Saudi Commission for Health Specialties ‚Äî Candidate Portal</div>
        </div>
      </div>

      <div class="timer" id="topTimer">60:00</div>
    </div>

    <div class="layout" role="main">
      <!-- Left: Preview -->
      <div>
        <div class="card">
          <h2>Test Preview</h2>
          <div class="muted">This area shows the live test runner. If embedding is blocked by the test server, use the "Open in new tab" button.</div>

          <div class="preview-wrap" id="previewWrap" style="margin-top:14px">
            <div id="embedArea" class="preview-empty">
              <div class="ico">üñ•Ô∏è</div>
              <div style="font-weight:700">Test preview will appear here</div>
              <div class="muted" style="margin-top:6px">Click <strong>Start Test</strong> to load the external test</div>
            </div>
          </div>

          <div class="controls">
            <button id="startBtn" class="btn primary">Start Test</button>
            <button id="pauseBtn" class="btn ghost">Pause (Demo)</button>
            <button id="openNew" class="btn ghost">Open in New Tab</button>
            <button id="fullscreen" class="btn ghost">Fullscreen</button>
          </div>

          <div class="note">Note: For real exam security, the external test may prevent embedding. If you see a blank preview, use "Open in New Tab". This mock preserves that behavior.</div>
        </div>

        <div class="card" style="margin-top:14px">
          <h2>Instructions</h2>
          <ol style="padding-left:18px;color:var(--muted)">
            <li>Check candidate details on the right panel.</li>
            <li>Click <strong>Start Test</strong> to load the test preview. If blocked, use <strong>Open in New Tab</strong>.</li>
            <li>When finished, follow the test runner's submit flow.</li>
          </ol>
        </div>
      </div>

      <!-- Right: Sidebar -->
      <aside>
        <div class="card meta">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="title">Candidate</div>
              <div style="font-weight:700">Guest Candidate</div>
            </div>
            <div class="status-bubble" id="status">Not started</div>
          </div>

          <div>
            <div class="title">Test</div>
            <div style="font-weight:700">SMLE ‚Äî Practice</div>
          </div>

          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="title">Duration</div>
              <div style="font-weight:700">60 minutes</div>
            </div>
            <div style="text-align:right">
              <div class="title">Questions</div>
              <div style="font-weight:700">50</div>
            </div>
          </div>

          <div style="margin-top:8px;border-radius:8px;padding:8px;background:linear-gradient(180deg,rgba(11,17,32,0.02),transparent)">
            <div class="title">Progress</div>
            <div style="font-weight:700">0 / 50</div>
          </div>

          <div style="margin-top:10px;display:flex;gap:8px">
            <button id="resumeBtn" class="btn primary" style="flex:1">Resume</button>
            <button id="endBtn" class="btn ghost" style="width:110px">End</button>
          </div>

          <div class="muted" style="margin-top:10px">Support: If embedding fails, open the external test link in a new tab.</div>

          <div style="margin-top:8px;word-break:break-all;background:#f3f6f4;padding:8px;border-radius:8px;font-size:13px">https://script.google.com/macros/s/AKfycby8o5Ei4aZog1y301nuD73V2XRjwLovY5GpkOjDsYKDrKsQOZLRY9qpU5w3MEcMPcEv/exec</div>
        </div>
      </aside>
    </div>

    <div style="text-align:center;margin-top:14px;color:var(--muted);font-size:13px">This mock is for practice only. Do not use real exam content or share confidential material.</div>
  </div>
<div class="card" style="margin-top:20px;">
  <h2>Candidate Verification</h2>

  <label>Name</label>
  <input id="candName" class="field" placeholder="Your full name">

  <label>WhatsApp Number</label>
  <input id="candWA" class="field" placeholder="e.g. +62xxx">

  <button id="submitInfo" class="btn primary" style="margin-top:10px;">
    Preview Test / Submit Info
  </button>

  <div id="infoMsg" class="muted" style="margin-top:8px;"></div>

  <hr style="margin:18px 0; border-color:rgba(255,255,255,0.06)">

  <label>Enter Unlock Code (given by Admin)</label>
  <input id="unlockInput" class="field" placeholder="Unlock code" disabled>

  <button id="verifyUnlock" class="btn ghost" disabled style="margin-top:10px;">
    Verify Unlock Code
  </button>

  <div id="unlockMsg" class="muted" style="margin-top:8px;"></div>

  <button id="continueRealTest" class="btn primary" disabled style="margin-top:16px;width:100%;font-size:16px;">
    Continue Test
  </button>
</div>

<style>
  .field{
    width:100%;padding:10px;margin:6px 0 12px;
    border-radius:8px;border:1px solid rgba(255,255,255,0.08);
    background:rgba(255,255,255,0.05);color:#fff;
  }
</style>

  <script>
    // CONFIG ‚Äî external test URL
    const TEST_URL = 'https://script.google.com/macros/s/AKfycbyZwfgqKBG3a1Oj0s4e_gI8hToW-Ud9smn7Ytqux8OyGyV9KqC1Q0ZyVAV_2jVu30BN/exec';

    // DOM
    const embedArea = document.getElementById('embedArea');
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const openNew = document.getElementById('openNew');
    const fullscreen = document.getElementById('fullscreen');
    const statusEl = document.getElementById('status');
    const resumeBtn = document.getElementById('resumeBtn');
    const endBtn = document.getElementById('endBtn');
    const topTimer = document.getElementById('topTimer');

    let iframeEl = null;
    let totalSeconds = 60 * 60; // 60 minutes
    let timerInterval = null;

    function startTimer(){
      clearInterval(timerInterval);
      timerInterval = setInterval(()=>{
        if(totalSeconds>0) totalSeconds--;
        const mm = String(Math.floor(totalSeconds/60)).padStart(2,'0');
        const ss = String(totalSeconds%60).padStart(2,'0');
        topTimer.textContent = mm + ':' + ss;
      },1000);
    }

    function stopTimer(){ clearInterval(timerInterval); }

    function createIframe(forceReload=false){
      // if there is already an iframe and no forceReload, focus it
      if(iframeEl && !forceReload) return iframeEl;

      // Create iframe and try to embed
      iframeEl = document.createElement('iframe');
      iframeEl.src = TEST_URL;
      iframeEl.title = 'SMLE Test Runner';
      iframeEl.style.width = '100%';
      iframeEl.style.height = '100%';
      iframeEl.style.border = '0';
      iframeEl.loading = 'lazy';

      // attach load and error handlers
      iframeEl.onload = function(){
        statusEl.textContent = 'In progress';
        statusEl.style.background = 'rgba(11,120,60,0.08)';
        startTimer();
      };

      // Replace embed area content
      embedArea.innerHTML = '';
      embedArea.appendChild(iframeEl);

      // Small probe: if after short delay the iframe has no visible content, we keep the fallback visible
      setTimeout(()=>{
        try{
          // try to read a property ‚Äî if cross-origin blocked this will throw when accessing contentWindow.document
          const doc = iframeEl.contentDocument || iframeEl.contentWindow.document;
          // if we can read title or body length it's loaded; just ignore otherwise
        }catch(e){
          // Likely blocked by X-Frame-Options/CSP ‚Äî keep the iframe but inform user
          statusEl.textContent = 'Embedding blocked ‚Äî open in new tab';
        }
      },1000);

      return iframeEl;
    }

    startBtn.addEventListener('click', ()=>{
      createIframe(true);
      statusEl.textContent = 'Starting...';
      statusEl.style.background = 'rgba(11,120,60,0.08)';
    });

    resumeBtn.addEventListener('click', ()=>{
      createIframe();
      statusEl.textContent = 'Resumed';
    });

    pauseBtn.addEventListener('click', ()=>{
      stopTimer();
      statusEl.textContent = 'Paused';
    });

    endBtn.addEventListener('click', ()=>{
      stopTimer();
      statusEl.textContent = 'Ended';
      // Optionally remove iframe to simulate end
      //embedArea.innerHTML = '<div class="preview-empty"><div style="font-weight:700">Test ended</div></div>';
    });

    openNew.addEventListener('click', ()=>{
      window.open(TEST_URL, '_blank');
      statusEl.textContent = 'Opened in new tab';
    });

    fullscreen.addEventListener('click', ()=>{
      if(iframeEl && iframeEl.requestFullscreen){
        iframeEl.requestFullscreen();
      } else {
        window.open(TEST_URL,'_blank');
      }
    });

    // Auto-embed on load (try to mimic SMLE behavior)
    window.addEventListener('DOMContentLoaded', ()=>{
      createIframe();
    });
  </script>
</body>
</html>
